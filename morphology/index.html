
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://abdo-eid.github.io/DIP_solver/morphology/">
      
      
        <link rel="prev" href="../neighborhood_operations/">
      
      
        <link rel="next" href="../plugins/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.42">
    
    
      
        <title>Morphology - DIP Solver Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#dipmorphology" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="DIP Solver Documentation" class="md-header__button md-logo" aria-label="DIP Solver Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            DIP Solver Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Morphology
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="blue"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="blue-grey" data-md-color-accent="blue"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Abdo-Eid/DIP_solver" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../helper/" class="md-tabs__link">
        
  
    
  
  Helper

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../operations/" class="md-tabs__link">
        
  
    
  
  Operations

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../segmentation/" class="md-tabs__link">
        
  
    
  
  Segmentation

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../neighborhood_operations/" class="md-tabs__link">
        
  
    
  
  Neighborhood Operations

      </a>
    </li>
  

      
        
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
    
  
  Morphology

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../plugins/" class="md-tabs__link">
        
  
    
  
  Plugins

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="DIP Solver Documentation" class="md-nav__button md-logo" aria-label="DIP Solver Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    DIP Solver Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Abdo-Eid/DIP_solver" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../helper/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Helper
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../operations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Operations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../segmentation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Segmentation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../neighborhood_operations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Neighborhood Operations
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Morphology
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Morphology
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology" class="md-nav__link">
    <span class="md-ellipsis">
      morphology
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.closing" class="md-nav__link">
    <span class="md-ellipsis">
      closing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.convex_hull" class="md-nav__link">
    <span class="md-ellipsis">
      convex_hull
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.convex_hull_gen" class="md-nav__link">
    <span class="md-ellipsis">
      convex_hull_gen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.dilation" class="md-nav__link">
    <span class="md-ellipsis">
      dilation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.erosion" class="md-nav__link">
    <span class="md-ellipsis">
      erosion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.external_extraction" class="md-nav__link">
    <span class="md-ellipsis">
      external_extraction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.hit_or_miss" class="md-nav__link">
    <span class="md-ellipsis">
      hit_or_miss
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.hole_filling" class="md-nav__link">
    <span class="md-ellipsis">
      hole_filling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.hole_filling_X_gen" class="md-nav__link">
    <span class="md-ellipsis">
      hole_filling_X_gen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.internal_extraction" class="md-nav__link">
    <span class="md-ellipsis">
      internal_extraction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.morphology_gradient" class="md-nav__link">
    <span class="md-ellipsis">
      morphology_gradient
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.opening" class="md-nav__link">
    <span class="md-ellipsis">
      opening
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.practical_dilation" class="md-nav__link">
    <span class="md-ellipsis">
      practical_dilation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plugins
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology" class="md-nav__link">
    <span class="md-ellipsis">
      morphology
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.closing" class="md-nav__link">
    <span class="md-ellipsis">
      closing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.convex_hull" class="md-nav__link">
    <span class="md-ellipsis">
      convex_hull
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.convex_hull_gen" class="md-nav__link">
    <span class="md-ellipsis">
      convex_hull_gen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.dilation" class="md-nav__link">
    <span class="md-ellipsis">
      dilation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.erosion" class="md-nav__link">
    <span class="md-ellipsis">
      erosion
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.external_extraction" class="md-nav__link">
    <span class="md-ellipsis">
      external_extraction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.hit_or_miss" class="md-nav__link">
    <span class="md-ellipsis">
      hit_or_miss
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.hole_filling" class="md-nav__link">
    <span class="md-ellipsis">
      hole_filling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.hole_filling_X_gen" class="md-nav__link">
    <span class="md-ellipsis">
      hole_filling_X_gen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.internal_extraction" class="md-nav__link">
    <span class="md-ellipsis">
      internal_extraction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.morphology_gradient" class="md-nav__link">
    <span class="md-ellipsis">
      morphology_gradient
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.opening" class="md-nav__link">
    <span class="md-ellipsis">
      opening
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#DIP.morphology.practical_dilation" class="md-nav__link">
    <span class="md-ellipsis">
      practical_dilation
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  
    
      
    
    <a href="https://github.com/Abdo-Eid/DIP_solver/raw/master/docs/morphology.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="dipmorphology">DIP.morphology</h1>


<div class="doc doc-object doc-module">



<a id="DIP.morphology"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.closing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">closing</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Perform closing operation on a matrix using a given structuring element (se).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>`matrix`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original binary matrix on which the closing operation is applied.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`se`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The structuring element used for the closing operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Matrix</code></td>            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the closing operation on the matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="description" open>
  <summary>Description</summary>
  <p>The closing process consists of a dilation followed by an erosion using the same structuring element.
This operation is useful for closing small holes in the foreground, bridging small gaps, and generally smoothing the outline of objects
while keeping their sizes and shapes approximately the same.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><span class="filename">Python Console Session</span><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> 
<span class="gp">... </span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> 
<span class="gp">... </span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">... </span>    <span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">closing</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span><span class="n">se</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">[[0, 0, 0, 0, 0, 0]</span>
<span class="go">,[0, 1, 1, 1, 1, 0]</span>
<span class="go">,[0, 1, 1, 1, 1, 0]</span>
<span class="go">,[0, 1, 1, 1, 1, 0]</span>
<span class="go">,[0, 1, 1, 1, 1, 0]]</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">closing</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform closing operation on a matrix using a given structuring element (se).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        `matrix` (Matrix): The original binary matrix on which the closing operation is applied.</span>
<span class="sd">        `se` (Matrix): The structuring element used for the closing operation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Matrix: The result of the closing operation on the matrix.</span>

<span class="sd">    Description:</span>
<span class="sd">        The closing process consists of a dilation followed by an erosion using the same structuring element.</span>
<span class="sd">        This operation is useful for closing small holes in the foreground, bridging small gaps, and generally smoothing the outline of objects</span>
<span class="sd">        while keeping their sizes and shapes approximately the same.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; matrix = [[0,0,0,0,0,0], </span>
<span class="sd">        ...          [0,1,1,1,1,0], </span>
<span class="sd">        ...          [0,1,1,0,1,0],</span>
<span class="sd">        ...          [0,1,1,0,1,0],</span>
<span class="sd">        ...          [0,1,1,1,1,0]]</span>
<span class="sd">        &gt;&gt;&gt; se = [[1,1]</span>
<span class="sd">        ...     ,[0,1]]</span>
<span class="sd">        &gt;&gt;&gt; result = closing(matrix,se)</span>
<span class="sd">        &gt;&gt;&gt; result</span>
<span class="sd">        [[0, 0, 0, 0, 0, 0]</span>
<span class="sd">        ,[0, 1, 1, 1, 1, 0]</span>
<span class="sd">        ,[0, 1, 1, 1, 1, 0]</span>
<span class="sd">        ,[0, 1, 1, 1, 1, 0]</span>
<span class="sd">        ,[0, 1, 1, 1, 1, 0]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dilated</span> <span class="o">=</span> <span class="n">dilation</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">erosion</span><span class="p">(</span><span class="n">dilated</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.convex_hull" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convex_hull</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">list_of_structures</span><span class="p">,</span> <span class="n">max_itiration</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the convex hull of a binary image using morphological operations.
The function applies hit-or-miss transformations with specified structuring elements,
iteratively refining the image until convergence or the maximum number of iterations is reached.
The output is a binary matrix representing the convex hull.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>matrix</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A binary matrix (2D list) representing the input image where non-zero values 
             indicate foreground pixels.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>list_of_structures</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="DIP.helper.Matrix">Matrix</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of structuring elements (binary matrices) used for 
                                 morphological operations. Each structuring element defines 
                                 the shape used in the hit-or-miss transformation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_itiration</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of iterations to perform. Default is 100. 
                            If convergence occurs before reaching this limit, the process will stop.</p>
              </div>
            </td>
            <td>
                  <code>100</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Matrix</code></td>            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A binary matrix representing the convex hull of the input image.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>ValueError</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If <code>matrix</code> is not a valid binary matrix or if <code>list_of_structures</code> is empty.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><span class="filename">Python Console Session</span><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">input_matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structures</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">convex_hull</span><span class="p">(</span><span class="n">input_matrix</span><span class="p">,</span> <span class="n">structures</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convex_hull</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">list_of_structures</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Matrix</span><span class="p">],</span> <span class="n">max_itiration</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the convex hull of a binary image using morphological operations.</span>
<span class="sd">    The function applies hit-or-miss transformations with specified structuring elements,</span>
<span class="sd">    iteratively refining the image until convergence or the maximum number of iterations is reached.</span>
<span class="sd">    The output is a binary matrix representing the convex hull.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        matrix (Matrix): A binary matrix (2D list) representing the input image where non-zero values </span>
<span class="sd">                         indicate foreground pixels.</span>
<span class="sd">        list_of_structures (List[Matrix]): A list of structuring elements (binary matrices) used for </span>
<span class="sd">                                             morphological operations. Each structuring element defines </span>
<span class="sd">                                             the shape used in the hit-or-miss transformation.</span>
<span class="sd">        max_itiration (int, optional): The maximum number of iterations to perform. Default is 100. </span>
<span class="sd">                                        If convergence occurs before reaching this limit, the process will stop.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Matrix: A binary matrix representing the convex hull of the input image.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If `matrix` is not a valid binary matrix or if `list_of_structures` is empty.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; input_matrix = [[0, 0, 1], [0, 1, 1], [0, 0, 0]]</span>
<span class="sd">        &gt;&gt;&gt; structures = [[[1]], [[1, 1]]]</span>
<span class="sd">        &gt;&gt;&gt; result = convex_hull(input_matrix, structures)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">DIP.neighborhood_operations</span> <span class="kn">import</span> <span class="n">pad</span>
    <span class="kn">from</span> <span class="nn">DIP.helper</span> <span class="kn">import</span> <span class="n">max_dimensions</span><span class="p">,</span> <span class="n">trim</span>
    <span class="n">max_dimension</span> <span class="o">=</span> <span class="n">max_dimensions</span><span class="p">(</span><span class="n">list_of_structures</span><span class="p">)</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">max_dimension</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">))]</span>
    <span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="n">list_of_structures</span><span class="p">:</span>
        <span class="n">X_prev</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_itiration</span><span class="p">):</span>
            <span class="n">X_k</span> <span class="o">=</span> <span class="n">hit_or_miss</span><span class="p">(</span><span class="n">X_prev</span><span class="p">,</span><span class="n">structure</span><span class="p">)</span>
            <span class="n">X_k</span> <span class="o">=</span> <span class="n">union</span><span class="p">(</span><span class="n">X_k</span><span class="p">,</span><span class="n">X_prev</span><span class="p">)</span>
            <span class="c1"># Check for convergence</span>
            <span class="k">if</span> <span class="n">X_k</span> <span class="o">==</span> <span class="n">X_prev</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="c1"># Update X_prev for next iteration</span>
            <span class="n">X_prev</span> <span class="o">=</span> <span class="n">X_k</span>

        <span class="n">result</span> <span class="o">=</span> <span class="n">union</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">X_k</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">trim</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="p">(</span><span class="n">max_dimension</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span><span class="n">max_dimension</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">//</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.convex_hull_gen" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convex_hull_gen</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">list_of_structures</span><span class="p">,</span> <span class="n">max_itiration</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generates intermediate results while computing the convex hull of a binary image using morphological operations.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>matrix</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A binary matrix (2D list) representing the input image where non-zero values 
             indicate foreground pixels.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>list_of_structures</code>
            </td>
            <td>
                  <code><span title="typing.List">List</span>[<span title="DIP.helper.Matrix">Matrix</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of structuring elements (binary matrices) used for 
                                 morphological operations. Each structuring element defines 
                                 the shape used in the hit-or-miss transformation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>max_itiration</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The maximum number of iterations to perform for each structuring 
                            element. Default is 10. The process stops if convergence occurs 
                            before reaching this limit.</p>
              </div>
            </td>
            <td>
                  <code>10</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>tuple[int, int, <span title="DIP.helper.Matrix">Matrix</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple[int, int, Matrix]: A tuple containing:
- The index of the structuring element being processed.
- The current iteration number.
- The current state of the binary matrix after applying transformations.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><span class="filename">Python Console Session</span><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">input_matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">structures</span> <span class="o">=</span> <span class="p">[[[</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">iteration</span><span class="p">,</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">convex_hull_gen</span><span class="p">(</span><span class="n">input_matrix</span><span class="p">,</span> <span class="n">structures</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Structure </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">, Iteration </span><span class="si">{</span><span class="n">iteration</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">convex_hull_gen</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">list_of_structures</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Matrix</span><span class="p">],</span> <span class="n">max_itiration</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">],</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates intermediate results while computing the convex hull of a binary image using morphological operations.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        matrix (Matrix): A binary matrix (2D list) representing the input image where non-zero values </span>
<span class="sd">                         indicate foreground pixels.</span>
<span class="sd">        list_of_structures (List[Matrix]): A list of structuring elements (binary matrices) used for </span>
<span class="sd">                                             morphological operations. Each structuring element defines </span>
<span class="sd">                                             the shape used in the hit-or-miss transformation.</span>
<span class="sd">        max_itiration (int, optional): The maximum number of iterations to perform for each structuring </span>
<span class="sd">                                        element. Default is 10. The process stops if convergence occurs </span>
<span class="sd">                                        before reaching this limit.</span>

<span class="sd">    Yields:</span>
<span class="sd">        Tuple[int, int, Matrix]: A tuple containing:</span>
<span class="sd">            - The index of the structuring element being processed.</span>
<span class="sd">            - The current iteration number.</span>
<span class="sd">            - The current state of the binary matrix after applying transformations.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; input_matrix = [[0, 0, 1], [0, 1, 1], [0, 0, 0]]</span>
<span class="sd">        &gt;&gt;&gt; structures = [[[1]], [[1, 1]]]</span>
<span class="sd">        &gt;&gt;&gt; for index, iteration, result in convex_hull_gen(input_matrix, structures):</span>
<span class="sd">        ...     print(f&quot;Structure {index}, Iteration {iteration}: {result}&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">DIP.neighborhood_operations</span> <span class="kn">import</span> <span class="n">pad</span>
    <span class="kn">from</span> <span class="nn">DIP.helper</span> <span class="kn">import</span> <span class="n">max_dimensions</span>
    <span class="n">max_dimension</span> <span class="o">=</span> <span class="n">max_dimensions</span><span class="p">(</span><span class="n">list_of_structures</span><span class="p">)</span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">pad</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">max_dimension</span><span class="p">)</span>

    <span class="n">result</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">))]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">structure</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">list_of_structures</span><span class="p">,</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">X_prev</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
        <span class="c1"># yielding x_0</span>
        <span class="k">yield</span> <span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">X_prev</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_itiration</span><span class="p">):</span>
            <span class="n">X_k</span> <span class="o">=</span> <span class="n">hit_or_miss</span><span class="p">(</span><span class="n">X_prev</span><span class="p">,</span><span class="n">structure</span><span class="p">)</span>
            <span class="n">X_k</span> <span class="o">=</span> <span class="n">union</span><span class="p">(</span><span class="n">X_k</span><span class="p">,</span><span class="n">X_prev</span><span class="p">)</span>
            <span class="c1"># Check for convergence</span>
            <span class="k">if</span> <span class="n">X_k</span> <span class="o">==</span> <span class="n">X_prev</span><span class="p">:</span>
                <span class="k">break</span>

            <span class="c1"># Update X_prev for next iteration</span>
            <span class="n">X_prev</span> <span class="o">=</span> <span class="n">X_k</span>
            <span class="k">yield</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">X_k</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">union</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">X_k</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">X_k</span>
    <span class="k">yield</span> <span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.dilation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dilation</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Perform set theoretic dilation of a binary matrix using a specified structuring element.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>`matrix`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original binary matrix where the dilation will be applied.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`se`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The structuring element that defines how the dilation is performed.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Matrix</code></td>            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The resulting binary matrix after dilation.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="description" open>
  <summary>Description</summary>
  <p>This function expands the bright areas (1s) in the input matrix based on the structuring element.
It first converts the structuring element into a set of relative positions.
Then, for each bright pixel (1) in the input matrix,
it adds the relative positions from the structuring element to create new bright pixels in the output matrix.
This means that if a bright pixel is found, all positions defined by the structuring element around it will also become bright.
The output matrix will have the same size as the input matrix.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    
        <p>```python
    &gt;&gt;&gt; matrix = [[0, 1, 0],
    ...           [0, 0, 0],
    ...           [1, 0, 0]]
    &gt;&gt;&gt; se = [[1, 1],
    ...       [1, 1]]
    &gt;&gt;&gt; result = dilation(matrix, se)
    &gt;&gt;&gt; result
    [[1, 1, 0]
    ,[1, 0, 0]
    ,[1, 0, 0]]</p>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dilation</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform set theoretic dilation of a binary matrix using a specified structuring element.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        `matrix` (Matrix): The original binary matrix where the dilation will be applied.</span>
<span class="sd">        `se` (Matrix): The structuring element that defines how the dilation is performed.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Matrix: The resulting binary matrix after dilation.</span>

<span class="sd">    Description:</span>
<span class="sd">        This function expands the bright areas (1s) in the input matrix based on the structuring element.</span>
<span class="sd">        It first converts the structuring element into a set of relative positions.</span>
<span class="sd">        Then, for each bright pixel (1) in the input matrix,</span>
<span class="sd">        it adds the relative positions from the structuring element to create new bright pixels in the output matrix.</span>
<span class="sd">        This means that if a bright pixel is found, all positions defined by the structuring element around it will also become bright.</span>
<span class="sd">        The output matrix will have the same size as the input matrix.</span>

<span class="sd">    Examples:</span>
<span class="sd">    ```python</span>
<span class="sd">        &gt;&gt;&gt; matrix = [[0, 1, 0],</span>
<span class="sd">        ...           [0, 0, 0],</span>
<span class="sd">        ...           [1, 0, 0]]</span>
<span class="sd">        &gt;&gt;&gt; se = [[1, 1],</span>
<span class="sd">        ...       [1, 1]]</span>
<span class="sd">        &gt;&gt;&gt; result = dilation(matrix, se)</span>
<span class="sd">        &gt;&gt;&gt; result</span>
<span class="sd">        [[1, 1, 0]</span>
<span class="sd">        ,[1, 0, 0]</span>
<span class="sd">        ,[1, 0, 0]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert structuring element to a set of relative coordinates</span>
    <span class="n">trans_set</span> <span class="o">=</span> <span class="n">structuring_element_to_set</span><span class="p">(</span><span class="n">se</span><span class="p">)</span>
    <span class="n">foreground_pixels</span> <span class="o">=</span> <span class="n">pixel_coordinates</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

    <span class="n">translated_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
    <span class="c1"># translate every pixel by the each value in translation set</span>
    <span class="k">for</span> <span class="n">pixel</span> <span class="ow">in</span> <span class="n">foreground_pixels</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">translation</span> <span class="ow">in</span> <span class="n">trans_set</span><span class="p">:</span>
            <span class="n">translated_set</span><span class="o">.</span><span class="n">add</span><span class="p">((</span><span class="n">pixel</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">translation</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pixel</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">translation</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

    <span class="n">matrix_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">matrix_height</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>

    <span class="n">dilated_matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matrix_width</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">matrix_height</span><span class="p">)]</span>

    <span class="c1"># Set the pixels in the result matrix to 1 where the dilated_pixels set contains coordinates</span>
    <span class="k">for</span> <span class="n">pixel_pos</span> <span class="ow">in</span> <span class="n">translated_set</span><span class="p">:</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">pixel_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">matrix_height</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">pixel_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">matrix_width</span><span class="p">:</span>
            <span class="n">dilated_matrix</span><span class="p">[</span><span class="n">pixel_pos</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">pixel_pos</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="k">return</span> <span class="n">dilated_matrix</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.erosion" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">erosion</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Perform erosion operation on a matrix using a given structuring element (se).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>`matrix`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original binary matrix on which the erosion is applied.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`se`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The structuring element used for the erosion operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Matrix</code></td>            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the erosion operation on the matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="description" open>
  <summary>Description</summary>
  <p>The erosion process involves sliding the <code>se</code> over the matrix and checking if all '1' pixels in the <code>se</code> align with '1' pixels in the matrix neighborhood.
If they do, the center pixel of the neighborhood is set to '1' in the output matrix; otherwise, it is set to '0'.
The output matrix has the same size as the input matrix.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    
        <p>```python
    &gt;&gt;&gt; matrix = [[1, 1, 0, 0],
    ...           [1, 1, 0, 0],
    ...           [0, 0, 1, 1],
    ...           [0, 0, 1, 1]]
    &gt;&gt;&gt; se = [[1, 1],
    ...       [1, 1]]
    &gt;&gt;&gt; result = erosion(matrix, se)
    &gt;&gt;&gt; result
    [[0, 0, 0, 0],
    [0, 1, 0, 0],
    [0, 0, 0, 0],
    [0, 0, 0, 1]]</p>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">erosion</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform erosion operation on a matrix using a given structuring element (se).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        `matrix` (Matrix): The original binary matrix on which the erosion is applied.</span>
<span class="sd">        `se` (Matrix): The structuring element used for the erosion operation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Matrix: The result of the erosion operation on the matrix.</span>

<span class="sd">    Description:</span>
<span class="sd">        The erosion process involves sliding the `se` over the matrix and checking if all &#39;1&#39; pixels in the `se` align with &#39;1&#39; pixels in the matrix neighborhood.</span>
<span class="sd">        If they do, the center pixel of the neighborhood is set to &#39;1&#39; in the output matrix; otherwise, it is set to &#39;0&#39;.</span>
<span class="sd">        The output matrix has the same size as the input matrix.</span>

<span class="sd">    Examples:</span>
<span class="sd">    ```python</span>
<span class="sd">        &gt;&gt;&gt; matrix = [[1, 1, 0, 0],</span>
<span class="sd">        ...           [1, 1, 0, 0],</span>
<span class="sd">        ...           [0, 0, 1, 1],</span>
<span class="sd">        ...           [0, 0, 1, 1]]</span>
<span class="sd">        &gt;&gt;&gt; se = [[1, 1],</span>
<span class="sd">        ...       [1, 1]]</span>
<span class="sd">        &gt;&gt;&gt; result = erosion(matrix, se)</span>
<span class="sd">        &gt;&gt;&gt; result</span>
<span class="sd">        [[0, 0, 0, 0],</span>
<span class="sd">        [0, 1, 0, 0],</span>
<span class="sd">        [0, 0, 0, 0],</span>
<span class="sd">        [0, 0, 0, 1]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">height</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
    <span class="n">width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="c1"># se = _rotate_180_clockwise(se)</span>
    <span class="n">se_h</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">)</span>
    <span class="n">se_w</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># output will be same size as original in this case</span>
    <span class="n">output_mat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">)]</span>

    <span class="c1"># make bigger padded matrix </span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">DN</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">matrix</span><span class="p">,(</span><span class="n">se_w</span><span class="p">,</span><span class="n">se_h</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
            <span class="n">window</span> <span class="o">=</span> <span class="n">slice_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">,(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">se_h</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">se_w</span><span class="p">))</span>
            <span class="n">output_mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">filter_by_kernel</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">se</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">output_mat</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.external_extraction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">external_extraction</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Extracts external structures from a binary image by performing morphological dilation 
followed by subtraction of the original image. This operation highlights outer 
boundaries of objects in the image.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>`matrix`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix Original binary image represented as a 2D list of 0s and 1s.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`se`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Structuring element used for erosion, represented as a 2D list.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Matrix</code></td>            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resulting binary image containing only the external boundaries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><span class="filename">Python Console Session</span><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">external_extraction</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Result will show the outer boundary surrounding the 2x2 square</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">external_extraction</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts external structures from a binary image by performing morphological dilation </span>
<span class="sd">    followed by subtraction of the original image. This operation highlights outer </span>
<span class="sd">    boundaries of objects in the image.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        `matrix` (Matrix): Matrix Original binary image represented as a 2D list of 0s and 1s.</span>
<span class="sd">        `se` (Matrix): Structuring element used for erosion, represented as a 2D list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Matrix: Resulting binary image containing only the external boundaries.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; img = [[0, 0, 0, 0],</span>
<span class="sd">        ...        [0, 1, 1, 0],</span>
<span class="sd">        ...        [0, 1, 1, 0],</span>
<span class="sd">        ...        [0, 0, 0, 0]]</span>
<span class="sd">        &gt;&gt;&gt; se = [[1, 1],</span>
<span class="sd">        ...       [1, 1]]</span>
<span class="sd">        &gt;&gt;&gt; result = external_extraction(img, se)</span>
<span class="sd">        &gt;&gt;&gt; # Result will show the outer boundary surrounding the 2x2 square</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dilated_matrix</span> <span class="o">=</span> <span class="n">dilation</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>

    <span class="c1"># Subtract the original image from the dilated image to get the external boundary</span>
    <span class="n">result_matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="n">DO</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">dilated_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">))]</span>

    <span class="k">return</span> <span class="n">result_matrix</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.hit_or_miss" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hit_or_miss</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se1</span><span class="p">,</span> <span class="n">se2</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Performs hit-or-miss transform (HMT) to detect specific patterns or templates
in binary images using two complementary structuring elements. If only one
structuring element is provided, it searches for exact matches while handling
don't care elements ('x').</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>`matrix`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary image containing holes to be filled.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`se1`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>First structuring element that matches foreground pixels (1s).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`se2`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Second structuring element that matches background pixels (0s).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Matrix</code></td>            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary image where 1s indicate locations where the pattern was found.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><span class="filename">Python Console Session</span><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se1</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Result will indicate the location of the pattern with &#39;x&#39; as a don&#39;t care</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">hit_or_miss</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">se1</span><span class="p">)</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">hit_or_miss</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">se1</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">se2</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Matrix</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs hit-or-miss transform (HMT) to detect specific patterns or templates</span>
<span class="sd">    in binary images using two complementary structuring elements. If only one</span>
<span class="sd">    structuring element is provided, it searches for exact matches while handling</span>
<span class="sd">    don&#39;t care elements (&#39;x&#39;).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        `matrix` (Matrix): Binary image containing holes to be filled.</span>
<span class="sd">        `se1` (Matrix): First structuring element that matches foreground pixels (1s).</span>
<span class="sd">        `se2` (Matrix, optional): Second structuring element that matches background pixels (0s).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Matrix: Binary image where 1s indicate locations where the pattern was found.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; img = [[1, 1, 0],</span>
<span class="sd">        ...        [1, 1, 0],</span>
<span class="sd">        ...        [0, 0, 0]]</span>
<span class="sd">        &gt;&gt;&gt; se1 = [[1, &#39;x&#39;],</span>
<span class="sd">        ...        [&#39;x&#39;, 1]]</span>
<span class="sd">        &gt;&gt;&gt; # Result will indicate the location of the pattern with &#39;x&#39; as a don&#39;t care</span>
<span class="sd">        &gt;&gt;&gt; result = hit_or_miss(img, se1)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">se2</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># If only one structuring element is provided, look for exact matches</span>
        <span class="n">k_h</span><span class="p">,</span> <span class="n">k_w</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">se1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">se1</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">))]</span>

        <span class="c1"># getting kernel center</span>
        <span class="n">x_offset</span><span class="p">,</span> <span class="n">y_offset</span> <span class="o">=</span> <span class="n">k_h</span><span class="o">//</span><span class="mi">2</span><span class="p">,</span> <span class="n">k_w</span><span class="o">//</span><span class="mi">2</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span> <span class="o">-</span> <span class="n">k_h</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">-</span> <span class="n">k_w</span><span class="p">):</span>
                <span class="n">match_found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k_h</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">k_w</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">se1</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;x&#39;</span> <span class="ow">and</span> <span class="n">se1</span><span class="p">[</span><span class="n">r</span><span class="p">][</span><span class="n">c</span><span class="p">]</span> <span class="o">!=</span> <span class="n">matrix</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">r</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="n">c</span><span class="p">]:</span>
                            <span class="n">match_found</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">match_found</span><span class="p">:</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">match_found</span><span class="p">:</span>
                    <span class="n">result</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="n">x_offset</span><span class="p">][</span><span class="n">j</span> <span class="o">+</span> <span class="n">y_offset</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># If both structuring elements are provided, proceed with the original logic</span>
        <span class="n">complement_A</span> <span class="o">=</span> <span class="n">DO</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">bit_depth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">A_erosion</span> <span class="o">=</span> <span class="n">erosion</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se1</span><span class="p">)</span>
        <span class="n">A_c_dilation</span> <span class="o">=</span> <span class="n">erosion</span><span class="p">(</span><span class="n">complement_A</span><span class="p">,</span> <span class="n">se2</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">intersection</span><span class="p">(</span><span class="n">A_erosion</span><span class="p">,</span> <span class="n">A_c_dilation</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.hole_filling" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hole_filling</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">,</span> <span class="n">x_0_indx</span><span class="p">,</span> <span class="n">max_itiration</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Fills holes in binary images using iterative morphological reconstruction based 
on a marker point. A hole is defined as a background region completely 
surrounded by foreground pixels.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>`matrix`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>binary image containing holes to be filled.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`se`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Structuring element.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`x_0_indx`</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Starting point coordinates (row, col) inside the hole to be filled. Must be a background pixel (0) surrounded by foreground pixels (1).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`max_itiration`</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of iterations for the filling process. Default is 100. Prevents infinite loops in case of non-convergence.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Matrix</code></td>            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Binary image with the specified hole filled.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><span class="filename">Python Console Session</span><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start_point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Coordinates inside the hole</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filled_img</span> <span class="o">=</span> <span class="n">hole_filling</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">se</span><span class="p">,</span> <span class="n">start_point</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Result will fill the 2x2 hole with 1s</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">hole_filling</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">x_0_indx</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span><span class="n">max_itiration</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fills holes in binary images using iterative morphological reconstruction based </span>
<span class="sd">    on a marker point. A hole is defined as a background region completely </span>
<span class="sd">    surrounded by foreground pixels.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        `matrix` (Matrix): binary image containing holes to be filled.</span>
<span class="sd">        `se` (Matrix): Structuring element.</span>
<span class="sd">        `x_0_indx` (Tuple[int,int]): Starting point coordinates (row, col) inside the hole to be filled. Must be a background pixel (0) surrounded by foreground pixels (1).</span>
<span class="sd">        `max_itiration` (int, optional): Maximum number of iterations for the filling process. Default is 100. Prevents infinite loops in case of non-convergence.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Matrix: Binary image with the specified hole filled.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; img = [[1, 1, 1, 1],</span>
<span class="sd">        ...        [1, 0, 0, 1],</span>
<span class="sd">        ...        [1, 0, 0, 1],</span>
<span class="sd">        ...        [1, 1, 1, 1]]</span>
<span class="sd">        &gt;&gt;&gt; se = [[0, 1, 0],</span>
<span class="sd">        ...       [1, 1, 1],</span>
<span class="sd">        ...       [0, 1, 0]]</span>
<span class="sd">        &gt;&gt;&gt; start_point = (1, 1)  # Coordinates inside the hole</span>
<span class="sd">        &gt;&gt;&gt; filled_img = hole_filling(img, se, start_point)</span>
<span class="sd">        &gt;&gt;&gt; # Result will fill the 2x2 hole with 1s</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">X_prev</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">))]</span>
    <span class="n">X_prev</span><span class="p">[</span><span class="n">x_0_indx</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">x_0_indx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">complement_A</span> <span class="o">=</span> <span class="n">DO</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_itiration</span><span class="p">):</span>
        <span class="c1"># Compute X_k = (X_{k-1}  B)  A^c</span>
        <span class="n">dilated_X_prev</span>  <span class="o">=</span> <span class="n">dilation</span><span class="p">(</span><span class="n">X_prev</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>
        <span class="n">X_k</span> <span class="o">=</span> <span class="n">intersection</span><span class="p">(</span><span class="n">dilated_X_prev</span><span class="p">,</span> <span class="n">complement_A</span><span class="p">)</span>

        <span class="c1"># Check for convergence</span>
        <span class="k">if</span> <span class="n">X_k</span> <span class="o">==</span> <span class="n">X_prev</span><span class="p">:</span>
            <span class="k">break</span>

        <span class="c1"># Update X_prev for next iteration</span>
        <span class="n">X_prev</span> <span class="o">=</span> <span class="n">X_k</span>

    <span class="c1"># Combine filled hole with original foreground</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">union</span><span class="p">(</span><span class="n">X_k</span><span class="p">,</span> <span class="n">matrix</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.hole_filling_X_gen" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">hole_filling_X_gen</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">,</span> <span class="n">x_0_indx</span><span class="p">,</span> <span class="n">max_itiration</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Generator version of hole filling algorithm that yields intermediate results 
during the filling process. Useful for visualizing the progression of the 
hole filling operation.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>`matrix`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>binary image containing holes to be filled.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`se`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Structuring element.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`x_0_indx`</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[int, int]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Starting point coordinates (row, col) inside the hole to be filled. Must be a background pixel (0) surrounded by foreground pixels (1).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`max_itiration`</code>
            </td>
            <td>
                  <code>int</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of iterations for the filling process. Default is 10. Lower than regular hole_filling as this is for visualization.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Yields:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Matrix</code></td>            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Intermediate binary images showing the progressive filling of the hole. Each yield represents one step in the iterative process.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><span class="filename">Python Console Session</span><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start_point</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get a list of 4 steps all filling</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xs</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">hole_filling_X_gen</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">se</span><span class="p">,</span> <span class="n">start_point</span><span class="p">,</span> <span class="n">max_itiration</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plot_morphology</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span> <span class="c1"># Custom function to show the matrix</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">hole_filling_X_gen</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">x_0_indx</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span><span class="nb">int</span><span class="p">],</span><span class="n">max_itiration</span><span class="p">:</span><span class="nb">int</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Generator</span><span class="p">[</span><span class="n">Matrix</span><span class="p">,</span><span class="kc">None</span><span class="p">,</span><span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generator version of hole filling algorithm that yields intermediate results </span>
<span class="sd">    during the filling process. Useful for visualizing the progression of the </span>
<span class="sd">    hole filling operation.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        `matrix` (Matrix): binary image containing holes to be filled.</span>
<span class="sd">        `se` (Matrix): Structuring element.</span>
<span class="sd">        `x_0_indx` (Tuple[int,int]): Starting point coordinates (row, col) inside the hole to be filled. Must be a background pixel (0) surrounded by foreground pixels (1).</span>
<span class="sd">        `max_itiration` (int, optional): Maximum number of iterations for the filling process. Default is 10. Lower than regular hole_filling as this is for visualization.</span>

<span class="sd">    Yields:</span>
<span class="sd">        Matrix: Intermediate binary images showing the progressive filling of the hole. Each yield represents one step in the iterative process.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; img = [[1, 1, 1, 1],</span>
<span class="sd">        ...        [1, 0, 0, 1],</span>
<span class="sd">        ...        [1, 0, 0, 1],</span>
<span class="sd">        ...        [1, 1, 1, 1]]</span>
<span class="sd">        &gt;&gt;&gt; se = [[0, 1, 0],</span>
<span class="sd">        ...       [1, 1, 1],</span>
<span class="sd">        ...       [0, 1, 0]]</span>
<span class="sd">        &gt;&gt;&gt; start_point = (1, 1)</span>
<span class="sd">        &gt;&gt;&gt; # get a list of 4 steps all filling</span>
<span class="sd">        &gt;&gt;&gt; xs = [*hole_filling_X_gen(img, se, start_point, max_itiration = 4)]</span>
<span class="sd">        &gt;&gt;&gt; plot_morphology(xs) # Custom function to show the matrix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">X_prev</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">))]</span>
    <span class="n">X_prev</span><span class="p">[</span><span class="n">x_0_indx</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">x_0_indx</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">complement_A</span> <span class="o">=</span> <span class="n">DO</span><span class="o">.</span><span class="n">complement</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">yield</span> <span class="n">X_prev</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_itiration</span><span class="p">):</span>
        <span class="c1"># Compute X_k = (X_{k-1}  B)  A^c</span>
        <span class="n">dilated_X_prev</span>  <span class="o">=</span> <span class="n">dilation</span><span class="p">(</span><span class="n">X_prev</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>
        <span class="n">X_k</span> <span class="o">=</span> <span class="n">intersection</span><span class="p">(</span><span class="n">dilated_X_prev</span><span class="p">,</span> <span class="n">complement_A</span><span class="p">)</span>

        <span class="c1"># Check for convergence</span>
        <span class="k">if</span> <span class="n">X_k</span> <span class="o">==</span> <span class="n">X_prev</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">X_k</span>
            <span class="k">break</span>

        <span class="c1"># Update X_prev for next iteration</span>
        <span class="n">X_prev</span> <span class="o">=</span> <span class="n">X_k</span>
        <span class="k">yield</span> <span class="n">X_k</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.internal_extraction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">internal_extraction</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Extracts internal structures from a binary image by performing morphological erosion 
followed by subtraction from the original image. This operation highlights inner 
boundaries of objects in the image.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>`matrix`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix Original binary image represented as a 2D list of 0s and 1s.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`se`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Structuring element used for erosion, represented as a 2D list.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Matrix</code></td>            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resulting binary image containing only the internal boundaries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><span class="filename">Python Console Session</span><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">internal_extraction</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Result will show the inner boundary of the 2x2 square</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">internal_extraction</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extracts internal structures from a binary image by performing morphological erosion </span>
<span class="sd">    followed by subtraction from the original image. This operation highlights inner </span>
<span class="sd">    boundaries of objects in the image.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        `matrix` (Matrix): Matrix Original binary image represented as a 2D list of 0s and 1s.</span>
<span class="sd">        `se` (Matrix): Structuring element used for erosion, represented as a 2D list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Matrix: Resulting binary image containing only the internal boundaries.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; img = [[0, 0, 0, 0],</span>
<span class="sd">        ...        [0, 1, 1, 0],</span>
<span class="sd">        ...        [0, 1, 1, 0],</span>
<span class="sd">        ...        [0, 0, 0, 0]]</span>
<span class="sd">        &gt;&gt;&gt; se = [[1, 1],</span>
<span class="sd">        ...       [1, 1]]</span>
<span class="sd">        &gt;&gt;&gt; result = internal_extraction(img, se)</span>
<span class="sd">        &gt;&gt;&gt; # Result will show the inner boundary of the 2x2 square</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">eroded_matrix</span> <span class="o">=</span> <span class="n">erosion</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>

    <span class="c1"># Subtract the eroded image from the original image to get the external boundary</span>
    <span class="n">result_matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="n">DO</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">eroded_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">))]</span>

    <span class="k">return</span> <span class="n">result_matrix</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.morphology_gradient" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">morphology_gradient</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Computes the morphological gradient of a binary image by taking the difference 
between dilated and eroded versions of the image. This operation highlights 
all boundaries in the image.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>`matrix`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Matrix Original binary image represented as a 2D list of 0s and 1s.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`se`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Structuring element used for erosion, represented as a 2D list.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Matrix</code></td>            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Resulting gradient image showing all boundaries.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><span class="filename">Python Console Session</span><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>       <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">morphology_gradient</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Result will show both inner and outer boundaries</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">morphology_gradient</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Computes the morphological gradient of a binary image by taking the difference </span>
<span class="sd">    between dilated and eroded versions of the image. This operation highlights </span>
<span class="sd">    all boundaries in the image.</span>

<span class="sd">    Parameters:</span>
<span class="sd">        `matrix` (Matrix): Matrix Original binary image represented as a 2D list of 0s and 1s.</span>
<span class="sd">        `se` (Matrix): Structuring element used for erosion, represented as a 2D list.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Matrix: Resulting gradient image showing all boundaries.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; img = [[0, 0, 0, 0],</span>
<span class="sd">        ...        [0, 1, 1, 0],</span>
<span class="sd">        ...        [0, 1, 1, 0],</span>
<span class="sd">        ...        [0, 0, 0, 0]]</span>
<span class="sd">        &gt;&gt;&gt; se = [[1, 1],</span>
<span class="sd">        ...       [1, 1]]</span>
<span class="sd">        &gt;&gt;&gt; result = morphology_gradient(img, se)</span>
<span class="sd">        &gt;&gt;&gt; # Result will show both inner and outer boundaries</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">dilated_matrix</span> <span class="o">=</span> <span class="n">dilation</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>

    <span class="n">eroded_matrix</span> <span class="o">=</span> <span class="n">erosion</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>

    <span class="n">result_matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="nb">abs</span><span class="p">(</span><span class="n">dilated_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">eroded_matrix</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">])</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">]))]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">))]</span>

    <span class="k">return</span> <span class="n">result_matrix</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.opening" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">opening</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Perform opening operation on a matrix using a given structuring element (se).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>`matrix`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original binary matrix on which the opening operation is applied.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`se`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The structuring element used for the opening operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Matrix</code></td>            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the opening operation on the matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="description" open>
  <summary>Description</summary>
  <p>The opening process consists of an erosion followed by a dilation using the same structuring element.
This operation is useful for removing small objects from the foreground (usually taken as the bright pixels) of an image,
placing them in the background, while preserving the shape and size of larger objects in the image.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><span class="filename">Python Console Session</span><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> 
<span class="gp">... </span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> 
<span class="gp">... </span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>         <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="go">        ,[0,1]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">opening</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span><span class="n">se</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">[[0, 0, 0, 0, 0, 0]</span>
<span class="go">,[0, 1, 1, 1, 1, 0]</span>
<span class="go">,[0, 1, 1, 0, 1, 0]</span>
<span class="go">,[0, 1, 1, 0, 0, 0]</span>
<span class="go">,[0, 0, 1, 0, 0, 0]]</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">opening</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform opening operation on a matrix using a given structuring element (se).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        `matrix` (Matrix): The original binary matrix on which the opening operation is applied.</span>
<span class="sd">        `se` (Matrix): The structuring element used for the opening operation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Matrix: The result of the opening operation on the matrix.</span>

<span class="sd">    Description:</span>
<span class="sd">        The opening process consists of an erosion followed by a dilation using the same structuring element.</span>
<span class="sd">        This operation is useful for removing small objects from the foreground (usually taken as the bright pixels) of an image,</span>
<span class="sd">        placing them in the background, while preserving the shape and size of larger objects in the image.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; matrix = [[0,0,0,0,0,0], </span>
<span class="sd">        ...          [0,1,1,1,1,0], </span>
<span class="sd">        ...          [0,1,1,0,1,0],</span>
<span class="sd">        ...          [0,1,1,0,1,0],</span>
<span class="sd">        ...          [0,1,1,1,1,0]]</span>
<span class="sd">        &gt;&gt;&gt; se = [[1,1]</span>
<span class="sd">                ,[0,1]]</span>
<span class="sd">        &gt;&gt;&gt; result = opening(matrix,se)</span>
<span class="sd">        &gt;&gt;&gt; result</span>
<span class="sd">        [[0, 0, 0, 0, 0, 0]</span>
<span class="sd">        ,[0, 1, 1, 1, 1, 0]</span>
<span class="sd">        ,[0, 1, 1, 0, 1, 0]</span>
<span class="sd">        ,[0, 1, 1, 0, 0, 0]</span>
<span class="sd">        ,[0, 0, 1, 0, 0, 0]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">eroded</span> <span class="o">=</span> <span class="n">erosion</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">dilation</span><span class="p">(</span><span class="n">eroded</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="DIP.morphology.practical_dilation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">practical_dilation</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Perform dilation operation on a matrix using a given structuring element (se).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>`matrix`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The original binary matrix on which the dilation is applied.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>`se`</code>
            </td>
            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The structuring element used for the dilation operation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
<th>Name</th>          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
<td><code>Matrix</code></td>            <td>
                  <code><span title="DIP.helper.Matrix">Matrix</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The result of the dilation operation on the matrix.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="description" open>
  <summary>Description</summary>
  <p>The dilation process involves sliding the <code>se</code> over the matrix and checking if any '1' pixel in the <code>se</code> aligns with a '1' pixel in the matrix neighborhood.
If such an overlap is found, the center pixel of the neighborhood is set to '1' in the output matrix; otherwise, it remains '0'.
The output matrix has the same size as the input matrix.</p>
</details>

<p><span class="doc-section-title">Examples:</span></p>
    <div class="highlight"><span class="filename">Python Console Session</span><pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">matrix</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>          <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>          <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
<span class="gp">... </span>          <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">se</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span>      <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">dilation</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span>
<span class="go">[[1, 1, 0, 0],</span>
<span class="go">[1, 1, 0, 0],</span>
<span class="go">[0, 0, 0, 0],</span>
<span class="go">[0, 0, 0, 1]]</span>
</code></pre></div>

            <details class="quote">
              <summary>Source code in <code>DIP/morphology.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">Python</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">practical_dilation</span><span class="p">(</span><span class="n">matrix</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">,</span> <span class="n">se</span><span class="p">:</span> <span class="n">Matrix</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Matrix</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Perform dilation operation on a matrix using a given structuring element (se).</span>

<span class="sd">    Parameters:</span>
<span class="sd">        `matrix` (Matrix): The original binary matrix on which the dilation is applied.</span>
<span class="sd">        `se` (Matrix): The structuring element used for the dilation operation.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Matrix: The result of the dilation operation on the matrix.</span>

<span class="sd">    Description:</span>
<span class="sd">        The dilation process involves sliding the `se` over the matrix and checking if any &#39;1&#39; pixel in the `se` aligns with a &#39;1&#39; pixel in the matrix neighborhood.</span>
<span class="sd">        If such an overlap is found, the center pixel of the neighborhood is set to &#39;1&#39; in the output matrix; otherwise, it remains &#39;0&#39;.</span>
<span class="sd">        The output matrix has the same size as the input matrix.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; matrix = [[1, 0, 0, 0],</span>
<span class="sd">        ...           [0, 0, 0, 0],</span>
<span class="sd">        ...           [0, 0, 0, 0],</span>
<span class="sd">        ...           [0, 0, 0, 1]]</span>
<span class="sd">        &gt;&gt;&gt; se = [[1, 1],</span>
<span class="sd">        ...       [1, 1]]</span>
<span class="sd">        &gt;&gt;&gt; result = dilation(matrix, se)</span>
<span class="sd">        &gt;&gt;&gt; result</span>
<span class="sd">        [[1, 1, 0, 0],</span>
<span class="sd">        [1, 1, 0, 0],</span>
<span class="sd">        [0, 0, 0, 0],</span>
<span class="sd">        [0, 0, 0, 1]]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">height</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
    <span class="n">width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="n">se_h</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">)</span>
    <span class="n">se_w</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">se</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># output will be same size as original in this case</span>
    <span class="n">output_mat</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">)]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">)]</span>

    <span class="c1"># make bigger padded matrix </span>
    <span class="n">matrix</span> <span class="o">=</span> <span class="n">DN</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">matrix</span><span class="p">,(</span><span class="n">se_w</span><span class="p">,</span><span class="n">se_h</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">):</span>
            <span class="n">window</span> <span class="o">=</span> <span class="n">slice_matrix</span><span class="p">(</span><span class="n">matrix</span><span class="p">,(</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="n">se_h</span><span class="p">),</span> <span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="n">se_w</span><span class="p">))</span>
            <span class="n">output_mat</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">filter_by_kernel</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="n">se</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">output_mat</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.action.view", "content.code.annotate", "content.code.copy", "content.code.select", "header.autohide", "navigation.tabs", "navigation.tabs.sticky", "navigation.expand", "navigation.indexes", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.prune", "navigation.sections", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>